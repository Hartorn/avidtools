from pydantic import BaseModel
from typing import List
from datetime import date

from .components import Affects, Problemtype, Metric, Reference, LangValue, Impact
from .enums import TypeEnum

class VulnMetadata(BaseModel):
    vuln_id: str

class ReportSummary(BaseModel):
    report_id: str
    type: TypeEnum
    name: str

class Vulnerability(BaseModel):
    data_type: str = 'AVID'
    data_version: str = None
    metadata: VulnMetadata = None
    affects: Affects = None
    problemtype: Problemtype = None
    metrics: List[Metric] = None
    references: List[Reference] = None
    description: LangValue = None
    reports: List[ReportSummary] = None
    impact: Impact = None
    credit: List[LangValue] = None
    published_date: date = None
    last_modified_date: date = None
        
    def save(self, location):
        with open(location, "w") as outfile:
            outfile.write(self.json(indent=4))